---
import Reveal from '@components/utils/Reveal.astro';

interface Props {
  id?: string;
  maxWidth?: 'max-w-3xl' | 'max-w-[720px]' | 'max-w-4xl' | 'max-w-6xl' | 'max-w-[980px]';
  padding?: string;
  useReveal?: boolean;
  nested?: boolean;
  ariaLabelledby?: string;
  class?: string;
  backgroundColor?: 'white' | 'gray' | 'none';
}

const {
  id,
  maxWidth = 'max-w-[720px]',
  padding = 'py-20 md:py-28',
  useReveal = true,
  nested = false,
  ariaLabelledby,
  class: className = '',
  backgroundColor = 'gray',
} = Astro.props;

const ariaAttrs = ariaLabelledby ? { 'aria-labelledby': ariaLabelledby } : {};

const bgClass =
  backgroundColor === 'white' ? 'bg-white' : backgroundColor === 'gray' ? 'bg-gray-50' : '';

// Auto-enable nested structure when background color is specified for full-width backgrounds
const useNested = nested || backgroundColor !== 'none';
---

{
  useReveal ? (
    <Reveal>
      {useNested ? (
        <section id={id} class={`${bgClass} ${padding} px-4 ${className}`} {...ariaAttrs}>
          <div class={`${maxWidth} mx-auto`}>
            <slot />
          </div>
        </section>
      ) : (
        <section
          id={id}
          class={`${bgClass} ${maxWidth} mx-auto px-4 ${padding} ${className}`}
          {...ariaAttrs}
        >
          <slot />
        </section>
      )}
    </Reveal>
  ) : useNested ? (
    <section id={id} class={`${bgClass} ${padding} px-4 ${className}`} {...ariaAttrs}>
      <div class={`${maxWidth} mx-auto`}>
        <slot />
      </div>
    </section>
  ) : (
    <section
      id={id}
      class={`${bgClass} ${maxWidth} mx-auto px-4 ${padding} ${className}`}
      {...ariaAttrs}
    >
      <slot />
    </section>
  )
}
